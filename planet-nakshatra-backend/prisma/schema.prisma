// Planet Nakshatra - Luxury Vedic Astrology Platform
// Production-ready Prisma schema for enterprise-grade backend

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

// ==========================================
// AUTHENTICATION & USER MANAGEMENT
// ==========================================

model User {
  id          String   @id @default(cuid())
  email       String   @unique
  password    String
  firstName   String
  lastName    String
  role        String @default("CLIENT")
  status      String @default("ACTIVE")
  phone       String?
  company     String?
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  // Relations
  consultations Consultation[]

  @@map("users")
}

// ==========================================
// SERVICES MANAGEMENT
// ==========================================

model Service {
  id          String   @id @default(cuid())
  title       String
  slug        String   @unique
  description String
  shortDescription String?
  category    String
  status      String @default("ACTIVE")

  // SEO & Metadata
  metaTitle       String?
  metaDescription String?
  keywords        String? // JSON string of keywords array

  // Content
  content         String? // JSON string of rich text content
  features        String? // JSON string of features array
  duration        String? // Service duration
  price           Float? // Service price
  currency        String @default("USD")

  // Media
  imageUrl        String?
  iconUrl         String?

  // Ordering & Display
  displayOrder    Int @default(0)
  featured        Boolean @default(false)

  // Timestamps
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt

  // Relations
  consultations   Consultation[]

  @@map("services")
}

// ==========================================
// CONSULTATION BOOKING SYSTEM
// ==========================================

model Consultation {
  id              String   @id @default(cuid())
  bookingReference String @unique @default(cuid())

  // Client Information
  clientName      String
  clientEmail     String
  clientPhone     String
  clientCompany   String?

  // Service Details
  serviceId       String
  service         Service @relation(fields: [serviceId], references: [id])

  // Scheduling
  scheduledDate   DateTime
  duration        Int @default(60) // minutes
  timezone        String @default("UTC")

  // Status & Notes
  status          String @default("PENDING")
  notes           String?
  adminNotes      String?

  // Payment (ready for future integration)
  paymentStatus   String @default("PENDING")
  amount          Float? // Consultation amount
  currency        String @default("USD")
  paymentId       String? // External payment provider ID

  // Audit
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt
  createdById     String?
  createdBy       User? @relation(fields: [createdById], references: [id])

  @@map("consultations")
}

// ==========================================
// CONTACT INQUIRIES
// ==========================================

model ContactInquiry {
  id          String   @id @default(cuid())
  reference   String   @unique @default(cuid())

  // Contact Information
  name        String
  email       String
  phone       String?
  message     String

  // Status & Tracking
  status      String @default("NEW") // NEW, READ, RESPONDED, CLOSED
  priority    String @default("NORMAL") // LOW, NORMAL, HIGH, URGENT

  // Metadata
  ipAddress   String?
  userAgent   String?
  source      String @default("WEBSITE") // WEBSITE, EMAIL, PHONE, etc.

  // Audit
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  respondedAt DateTime?
  respondedBy String?

  @@map("contact_inquiries")
}

// ==========================================
// CMS - CONTENT MANAGEMENT SYSTEM
// ==========================================

model Page {
  id          String   @id @default(cuid())
  title       String
  slug        String   @unique
  content     String // JSON string of rich text content
  status      String @default("DRAFT")

  // SEO & Metadata
  metaTitle       String?
  metaDescription String?
  keywords        String? // JSON string of keywords array
  canonicalUrl    String?

  // Media
  featuredImage   String?
  bannerImage     String?

  // Settings
  showInNavigation Boolean @default(false)
  navigationOrder  Int @default(0)

  // Audit
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt
  createdById     String?
  updatedById     String?

  @@map("pages")
}

// ==========================================
// ANALYTICS & SEO
// ==========================================

model SeoMetadata {
  id          String   @id @default(cuid())
  pageType    String // 'home', 'service', 'page', etc.
  pageId      String? // Reference to specific page/service
  url         String   @unique

  // SEO Data
  title       String
  description String
  keywords    String? // JSON string of keywords array
  canonical   String?

  // Open Graph
  ogTitle     String?
  ogDescription String?
  ogImage     String?
  ogType      String @default("website")

  // Twitter Cards
  twitterCard String @default("summary_large_image")
  twitterSite String?

  // Structured Data (JSON-LD ready)
  structuredData String? // JSON string

  // Analytics
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@map("seo_metadata")
}

// ==========================================
// SYSTEM CONFIGURATION
// ==========================================

model SystemConfig {
  id    String @id @default(cuid())
  key   String @unique
  value String // JSON string

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("system_config")
}

// ==========================================
// AUDIT LOGS
// ==========================================

model AuditLog {
  id        String   @id @default(cuid())
  userId    String?
  action    String // Audit action
  entity    String // 'user', 'service', 'consultation', etc.
  entityId  String?
  details   String? // JSON string
  ipAddress String?
  userAgent String?

  createdAt DateTime @default(now())

  @@map("audit_logs")
}
